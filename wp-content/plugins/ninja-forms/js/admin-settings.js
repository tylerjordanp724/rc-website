jQuery(document).ready((function(e){var n,t,o,a,r,d,l,i,s,c,f,u,m,p,y=!1;t=document.createElement("div"),o=document.createElement("p"),(a=document.createElement("input")).type="text",a.id="confirmDeleteInput",(d=document.createElement("div")).style.marginTop="10px",d.style.backgroundColor="#f4f5f6",(l=document.createElement("div")).style.padding="8px",l.style.cursor="default",l.style.backgroundColor="#d9534f",l.style.borderColor="#d9534f",l.style.fontSize="14pt",l.style.fontWeight="bold",l.style.color="#ffffff",l.style.borderRadius="4px",(i=document.createElement("div")).style.padding="8px",i.style.cursor="default",i.style.backgroundColor="#5bc0de",i.style.borderColor="#5bc0de",i.style.fontSize="14pt",i.style.fontWeight="bold",i.style.color="#ffffff",i.style.borderRadius="4px",s=document.createElement("br"),t.classList.add("message"),o.innerHTML+="This will DELETE all forms, form submissions, and deactivate Ninja Forms",o.appendChild(s),o.innerHTML+='<br>Type <span style="color:red;">DELETE</span> to confirm',t.appendChild(o),t.appendChild(a),t.appendChild(s),(r=document.createElement("div")).id="progressMsg",r.style.display="none",r.style.color="red",t.appendChild(r),l.innerHTML="Delete",l.classList.add("confirm","nf-button","primary"),l.style.float="left",i.innerHTML="Cancel",i.classList.add("cancel","nf-button","secondary","cancel-delete-all"),i.style.float="right",d.appendChild(l),d.appendChild(i),d.classList.add("buttons"),t.appendChild(d),(n=document.createElement("div")).appendChild(t),(p=document.createElement("input")).setAttribute("type","text"),p.id="downgradeConfirmInput",p.style.marginBottom="15px",p.style.padding="7px",p.style.border="1px solid #D3D3D3",p.style.width="100%",p.style.height="3em",(m=document.createElement("p")).innerHTML=nfAdmin.i18n.downgradeConfirmMessage,(u=document.createElement("p")).innerHTML=nfAdmin.i18n.downgradeWarningMessage,u.style.color="red",(f=document.createElement("h3")).innerHTML=nfAdmin.i18n.downgradeMessage,(c=document.createElement("div")).appendChild(f),c.appendChild(u),c.appendChild(m),c.appendChild(p),deleteAllDataModal=new jBox("Modal",{width:450,addClass:"dashboard-modal",overlay:!0,closeOnClick:"body"}),deleteAllDataModal.setContent(n.innerHTML),deleteAllDataModal.setTitle("Delete All Ninja Forms Data?"),deleteAllDataModal.container[0].getElementsByClassName("cancel")[0].addEventListener("click",(function(){y||deleteAllDataModal.close()}));var g=function(n){var t=0;e("#progressMsg").html("Deleting submissions for "+nfAdmin.forms[n].title+" ( ID: "+nfAdmin.forms[n].id+" )"),e("#progressMsg").show(),n===nfAdmin.forms.length-1&&(t=1),e.post(nfAdmin.ajax_url,{action:"nf_delete_all_data",form:nfAdmin.forms[n].id,security:nfAdmin.nonce,last_form:t}).then((function(e){if(n+=1,(e=JSON.parse(e)).data.hasOwnProperty("errors")){var t=e.data.errors;return Array.isArray(t)?t.forEach((function(e){t+=e+"\n"})):t=t,console.log("Delete All Data Errors: ",t),alert(t),null}e.data.success&&(n<nfAdmin.forms.length?g(n):e.data.plugin_url&&(window.location=e.data.plugin_url))})).fail((function(e,t,o){console.log(e.status+" "+o+"\r\nThere was an error deleting submissions for "+nfAdmin.forms[n].title)}))};deleteAllDataModal.container[0].getElementsByClassName("confirm")[0].addEventListener("click",(function(){var n=e("#confirmDeleteInput").val();if(!y)if(y=!0,"DELETE"===n){this.style.backgroundColor="#9f9f9f",this.style.borderColor="#3f3f3f";var t=e(".cancel-delete-all");t.css("backgroundColor","#9f9f9f"),t.css("borderColor","#3f3f3f"),g(0)}else deleteAllDataModal.close(),y=!1})),e(".js-delete-saved-field").click((function(){var n=this,t={action:"nf_delete_saved_field",field:{id:e(n).data("id")},security:nfAdmin.nonce};e.post(nfAdmin.ajax_url,t).done((function(t){e(n).closest("tr").fadeOut().remove()}))})),jQuery("#nfDowngrade").click((function(n){var t={class:"nfDowngradeModal",closeOnClick:"body",closeOnEsc:!0,content:c.innerHTML,btnPrimary:{text:nfAdmin.i18n.downgradeButtonPrimary,class:"nfDowngradeButtonPrimary",callback:function(n){if("disabled"!==e(".nfDowngradeButtonPrimary").prop("disabled")){var t=window.location.href;(t=t.split("?"))[0]=t[0]+"?page=ninja-forms&nf-switcher=rollback&security="+nfAdmin.nonce,window.location.replace(t[0])}}},btnSecondary:{text:nfAdmin.i18n.downgradeButtonSecondary,class:"nfDowngradeButtonSecondary",callback:function(e){o.toggleModal(!1)}},useProgressBar:!1},o=new NinjaModal(t);e(".nfDowngradeButtonPrimary").css("background","#ccc"),e(".nfDowngradeButtonPrimary").css("border","#ccc 1px solid"),e(".nfDowngradeButtonPrimary").prop("disabled","disabled"),e("#downgradeConfirmInput").on("keyup",(function(){"DOWNGRADE"==e("#downgradeConfirmInput").val()&&(e(".nfDowngradeButtonPrimary").css("background","#1EA9EA"),e(".nfDowngradeButtonPrimary").css("border","#1EA9EA 1px solid"),e(".nfDowngradeButtonPrimary").prop("disabled","")),"DOWNGRADE"!==e("#downgradeConfirmInput").val()&&(e(".nfDowngradeButtonPrimary").css("background","#ccc"),e(".nfDowngradeButtonPrimary").css("border","#ccc 1px solid"),e(".nfDowngradeButtonPrimary").prop("disabled","disabled"))}))})),e(document).on("click","#delete_on_uninstall",(function(e){deleteAllDataModal.open()})),e(document).on("click",".nf-delete-on-uninstall-yes",(function(n){n.preventDefault(),e("#delete_on_uninstall").attr("checked",!0)})),"1"==nfAdmin.allow_telemetry?(e("#nfTelOptin").addClass("hidden"),e("#nfTelOptout").removeClass("hidden")):(e("#nfTelOptout").addClass("hidden"),e("#nfTelOptin").removeClass("hidden")),e("#nfTelOptin").click((function(n){e("#nfTelOptin").addClass("hidden"),e("#nfTelSpinner").css("display","inline-block"),e.post(ajaxurl,{action:"nf_optin",ninja_forms_opt_in:1},(function(n){e("#nfTelOptout").removeClass("hidden"),e("#nfTelSpinner").css("display","none")}))})),e("#nfTelOptout").click((function(n){e("#nfTelOptout").addClass("hidden"),e("#nfTelSpinner").css("display","inline-block"),e.post(ajaxurl,{action:"nf_optin",ninja_forms_opt_in:0},(function(n){e("#nfTelOptin").removeClass("hidden"),e("#nfTelSpinner").css("display","none")}))})),jQuery("#nfTrashExpiredSubmissions").click((function(e){var n={content:"<p>"+nfAdmin.i18n.trashExpiredSubsMessage+"</p>",btnPrimaryText:nfAdmin.i18n.trashExpiredSubsButtonPrimary,btnSecondaryText:nfAdmin.i18n.trashExpiredSubsButtonSecondary,batch_type:"expired_submission_cleanup"};new NinjaBatchProcessor(n)})),jQuery("#nfRemoveMaintenanceMode").click((function(n){var t=this;jQuery(this).addClass("disabled").attr("disabled","disabled"),jQuery("#nf_maintenanceModeProgress").html("<strong>Removing Maintenance Mode...</strong>"),jQuery("#nf_maintenanceModeProgress").fadeIn(1);var o={action:"nf_remove_maintenance_mode",security:nf_settings.nonce};e.post(nf_settings.ajax_url,o).then((function(e){(e=JSON.parse(e)).data.errors&&console.log(e.data.errors),jQuery(t).removeClass("disabled").removeAttr("disabled"),jQuery("#nf_maintenanceModeProgress").html("<strong>Done.</strong>"),jQuery("#nf_maintenanceModeProgress").fadeOut(600)})).fail((function(e,n,t){console.log(e.status+" "+t+"\r\nThere was an error resetting maintenance mode")}))}))}));