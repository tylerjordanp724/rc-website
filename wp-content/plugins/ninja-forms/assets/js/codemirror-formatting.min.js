!function(){function e(e,n,r,t){var o=e.getMode(),a=e.getLine(n);if(null==t&&(t=a.length),!o.innerMode)return[{from:r,to:t,mode:o}];var i=e.getTokenAt({line:n,ch:r}).state,s=CodeMirror.innerMode(o,i).mode,c=[],d=new CodeMirror.StringStream(a);for(d.pos=d.start=r;;){o.token(d,i);var l=CodeMirror.innerMode(o,i).mode;if(l!=s){var m=d.start;"xml"==s.name&&">"==a.charAt(d.pos-1)&&(m=d.pos),c.push({from:r,to:m,mode:s}),r=m,s=l}if(d.pos>=t)break;d.start=d.pos}return t>r&&c.push({from:r,to:t,mode:s}),c}CodeMirror.extendMode("css",{commentStart:"/*",commentEnd:"*/",wordWrapChars:[";","\\{","\\}"],autoFormatLineBreaks:function(e){return e.replace(new RegExp("(;|\\{|\\})([^\r\n])","g"),"$1\n$2")}}),CodeMirror.extendMode("javascript",{commentStart:"/*",commentEnd:"*/",wordWrapChars:[";","\\{","\\}"],autoFormatLineBreaks:function(e){var n=0,r=this.jsonMode?function(e){return e.replace(/([,{])/g,"$1\n").replace(/}/g,"\n}")}:function(e){return e.replace(/(;|\{|\})([^\r\n;])/g,"$1\n$2")},t=function(e){for(var n=[/for\s*?\((.*?)\)/,/\"(.*?)(\"|$)/,/\'(.*?)(\'|$)/,/\/\*(.*?)(\*\/|$)/,/\/\/.*/],r=[],t=0;t<n.length;t++)for(var o=0;o<e.length;){var a=e.substr(o).match(n[t]);if(null==a)break;r.push({start:o+a.index,end:o+a.index+a[0].length}),o+=a.index+Math.max(1,a[0].length)}return r.sort((function(e,n){return e.start-n.start})),r}(e),o="";if(null!=t){for(var a=0;a<t.length;a++)t[a].start>n&&(o+=r(e.substring(n,t[a].start)),n=t[a].start),t[a].start<=n&&t[a].end>=n&&(o+=e.substring(n,t[a].end),n=t[a].end);n<e.length&&(o+=r(e.substr(n)))}else o=r(e);return o.replace(/^\n*|\n*$/,"")}}),CodeMirror.extendMode("xml",{commentStart:"\x3c!--",commentEnd:"--\x3e",wordWrapChars:[">"],autoFormatLineBreaks:function(e){for(var n=e.split("\n"),r=new RegExp("(^\\s*?<|^[^<]*?)(.+)(>\\s*?$|[^>]*?$)"),t=new RegExp("<","g"),o=new RegExp("(>)([^\r\n])","g"),a=0;a<n.length;a++){var i=n[a].match(r);null!=i&&i.length>3&&(n[a]=i[1]+i[2].replace(t,"\n$&").replace(o,"$1\n$2")+i[3])}return n.join("\n")}}),CodeMirror.defineExtension("commentRange",(function(e,n,r){var t=function(e,n){return CodeMirror.innerMode(e.getMode(),e.getTokenAt(n).state).mode}(this,n),o=this;this.operation((function(){if(e)o.replaceRange(t.commentEnd,r),o.replaceRange(t.commentStart,n),n.line==r.line&&n.ch==r.ch&&o.setCursor(n.line,n.ch+t.commentStart.length);else{var a=o.getRange(n,r),i=a.indexOf(t.commentStart),s=a.lastIndexOf(t.commentEnd);i>-1&&s>-1&&s>i&&(a=a.substr(0,i)+a.substring(i+t.commentStart.length,s)+a.substr(s+t.commentEnd.length)),o.replaceRange(a,n,r)}}))})),CodeMirror.defineExtension("autoIndentRange",(function(e,n){var r=this;this.operation((function(){for(var t=e.line;t<=n.line;t++)r.indentLine(t,"smart")}))})),CodeMirror.defineExtension("autoFormatRange",(function(n,r){var t=this;t.operation((function(){for(var o=n.line,a=r.line;a>=o;++o){for(var i={line:o,ch:o==n.line?n.ch:0},s={line:o,ch:o==a?r.ch:null},c=e(t,o,i.ch,s.ch),d="",l=t.getRange(i,s),m=0;m<c.length;++m){var u=c.length>1?l.slice(c[m].from,c[m].to):l;d&&(d+="\n"),d+=c[m].mode.autoFormatLineBreaks?c[m].mode.autoFormatLineBreaks(u):l}if(d!=l){for(var f=0,g=d.indexOf("\n");-1!=g;g=d.indexOf("\n",g+1),++f);t.replaceRange(d,i,s),o+=f,a+=f}}for(o=n.line+1;a>=o;++o)t.indentLine(o,"smart");t.setSelection(n,t.getCursor(!1))}))}))}();